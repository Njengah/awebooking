{"version":3,"file":"search-form.js","sources":["assets/babel/search-form/model.js","assets/babel/search-form/index.js","assets/babel/search-form.js"],"sourcesContent":["import plugin from 'awebooking'\n\nconst SearchModel = (($) => {\n  'use strict';\n\n  function formatDate(date, format) {\n    const _date = plugin.utils.dates.parse(date, 'Y-m-d');\n\n    if (!_date) {\n      return '';\n    }\n\n    return plugin.utils.dates.format(_date, format || plugin.i18n.dateFormat);\n  }\n\n  class Model {\n    constructor(data = {}) {\n      this.adults = ko.observable(data.adults || 1)\n      this.children = ko.observable(data.children || 0)\n      this.infants = ko.observable(data.infants || 0)\n      this.checkIn = ko.observable(data.checkIn || '')\n      this.checkOut = ko.observable(data.checkOut || '')\n\n      this.checkInDate = ko.computed(() => {\n        return formatDate(this.checkIn(), 'Y-m-d')\n      })\n\n      this.checkOutDate = ko.computed(() => {\n        return formatDate(this.checkOut(), 'Y-m-d')\n      })\n    }\n\n    checkInFormatted(format) {\n      return formatDate(this.checkIn(), format)\n    }\n\n    checkOutFormatted(format) {\n      return formatDate(this.checkOut(), format)\n    }\n  }\n\n  return Model;\n})(jQuery);\n\nexport default SearchModel\n","import ko from 'ko'\nimport $ from 'jquery'\nimport plugin from 'awebooking'\nimport SearchFormModel from './model'\n\nclass SearchForm {\n  constructor (el) {\n    const self = this;\n\n    this.$el = $(el);\n\n    this.model = new SearchFormModel({\n      adults: this.$el.find('input[name=\"adults\"]').val(),\n      children: this.$el.find('input[name=\"children\"]').val(),\n      infants: this.$el.find('input[name=\"infants\"]').val(),\n      checkIn: this.$el.find('input[name=\"check_in\"]').val(),\n      checkOut: this.$el.find('input[name=\"check_out\"]').val(),\n    });\n\n    ko.applyBindings(this.model, el);\n\n    let $rangepicker = this.$el.find('[data-hotel=\"rangepicker\"]');\n    if ($rangepicker.length === 0) {\n      $rangepicker = $('<input type=\"text\" data-hotel=\"rangepicker\"/>').appendTo(this.$el);\n    }\n\n    const fp = plugin.datepicker($rangepicker[0], {\n      mode: 'range',\n      inline: true,\n      altInput: false,\n      clickOpens: false,\n      closeOnSelect: true,\n      appendTo: self.$el.find('.searchbox__popup')[0],\n\n      onReady(_, __, fp) {\n        fp.calendarContainer.classList.add('awebooking-datepicker')\n        this.config.ignoredFocusElements.push($('.searchbox__box--checkin', self.$el)[0]);\n        this.config.ignoredFocusElements.push($('.searchbox__box--checkout', self.$el)[0]);\n      },\n\n      onChange: (dates) => {\n        if (dates.length === 0) {\n          this.model.checkIn(null);\n          this.model.checkIn(null);\n        } else if (dates.length === 1) {\n          this.model.checkIn(dates[0]);\n          this.model.checkOut(null);\n        } else {\n          this.model.checkIn(dates[0]);\n          this.model.checkOut(dates[1]);\n        }\n      },\n\n      onPreCalendarPosition(_, __, fp) {\n        fp._positionElement = $('.searchbox__box--checkout', self.$el)[0];\n        setTimeout(() => { this._positionElement = this._input; }, 0);\n      },\n    });\n\n    $(this.$el).on('click', '.searchbox__box--checkin, .searchbox__box--checkout', (e) => {\n      e.preventDefault();\n\n      fp.isOpen = false;\n      fp.open(undefined, e.currentTarget);\n    });\n\n    $('.searchbox__box', this.$el).each((i, box) => {\n      $(box).data('popup', this.setuptPopper(box));\n    });\n\n    $('[data-trigger=\"spinner\"]', this.$el).on('changed.spinner', function () {\n      $(this).find('[data-spin=\"spinner\"]').trigger('change');\n    });\n  }\n\n  setuptPopper(el) {\n    const $html = $(el).find('.searchbox__popup');\n\n    if ($html.length === 0) {\n      return;\n    }\n\n    plugin.utils.dropdown($(el).find('.searchbox__box-wrap'), {\n      drop: '.searchbox__popup',\n      display: 'static',\n    });\n  }\n}\n\nexport default SearchForm\n","import $ from 'jquery'\nimport SearchForm from './search-form/index'\n\n$(function () {\n  $('.awebooking .searchbox, .awebooking-block .searchbox').each((i, el) => {\n    new SearchForm(el)\n  })\n})\n"],"names":["SearchModel","$","formatDate","date","format","_date","plugin","utils","dates","parse","i18n","dateFormat","Model","data","adults","ko","observable","children","infants","checkIn","checkOut","checkInDate","computed","checkOutDate","jQuery","SearchForm","el","self","$el","model","SearchFormModel","find","val","applyBindings","$rangepicker","length","appendTo","fp","datepicker","mode","inline","altInput","clickOpens","closeOnSelect","onReady","_","__","calendarContainer","classList","add","config","ignoredFocusElements","push","onChange","onPreCalendarPosition","_positionElement","setTimeout","_input","on","e","preventDefault","isOpen","open","undefined","currentTarget","each","i","box","setuptPopper","trigger","$html","dropdown","drop","display"],"mappings":"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"}