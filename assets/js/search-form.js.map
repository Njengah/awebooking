{"version":3,"file":"search-form.js","sources":["assets/babel/search-form/model.js","assets/babel/search-form/index.js","assets/babel/search-form.js"],"sourcesContent":["import plugin from 'awebooking'\n\nconst SearchModel = (($) => {\n  'use strict';\n\n  function formatDate(date, format) {\n    const _date = plugin.utils.dates.parse(date, 'Y-m-d');\n\n    if (!_date) {\n      return '';\n    }\n\n    return plugin.utils.dates.format(_date, format || plugin.i18n.dateFormat);\n  }\n\n  class Model {\n    constructor(data = {}) {\n      this.adults = ko.observable(data.adults || 1)\n      this.children = ko.observable(data.children || 0)\n      this.infants = ko.observable(data.infants || 0)\n      this.checkIn = ko.observable(data.checkIn || '')\n      this.checkOut = ko.observable(data.checkOut || '')\n\n      this.checkInDate = ko.computed(() => {\n        return formatDate(this.checkIn(), 'Y-m-d')\n      })\n\n      this.checkOutDate = ko.computed(() => {\n        return formatDate(this.checkOut(), 'Y-m-d')\n      })\n    }\n\n    checkInFormatted(format) {\n      return formatDate(this.checkIn(), format)\n    }\n\n    checkOutFormatted(format) {\n      return formatDate(this.checkOut(), format)\n    }\n  }\n\n  return Model;\n})(jQuery);\n\nexport default SearchModel\n","import ko from 'ko'\nimport $ from 'jquery'\nimport plugin from 'awebooking'\nimport SearchFormModel from './model'\n\nclass SearchForm {\n  constructor (el) {\n    const self = this;\n\n    this.$el = $(el);\n\n    this.model = new SearchFormModel({\n      adults: this.$el.find('input[name=\"adults\"]').val(),\n      children: this.$el.find('input[name=\"children\"]').val(),\n      infants: this.$el.find('input[name=\"infants\"]').val(),\n      checkIn: this.$el.find('input[name=\"check_in\"]').val(),\n      checkOut: this.$el.find('input[name=\"check_out\"]').val(),\n    });\n\n    ko.applyBindings(this.model, el);\n\n    let $rangepicker = this.$el.find('[data-hotel=\"rangepicker\"]');\n    if ($rangepicker.length === 0) {\n      $rangepicker = $('<input type=\"text\" data-hotel=\"rangepicker\"/>').appendTo(this.$el);\n    }\n\n    const fp = plugin.datepicker($rangepicker[0], {\n      mode: 'range',\n      inline: true,\n      altInput: false,\n      clickOpens: false,\n      closeOnSelect: true,\n      appendTo: self.$el.find('.searchbox__popup')[0],\n\n      onReady(_, __, fp) {\n        fp.calendarContainer.classList.add('awebooking-datepicker')\n        this.config.ignoredFocusElements.push($('.searchbox__box--checkin', self.$el)[0]);\n        this.config.ignoredFocusElements.push($('.searchbox__box--checkout', self.$el)[0]);\n      },\n\n      onChange: (dates) => {\n        if (dates.length === 0) {\n          this.model.checkIn(null);\n          this.model.checkIn(null);\n        } else if (dates.length === 1) {\n          this.model.checkIn(dates[0]);\n          this.model.checkOut(null);\n        } else {\n          this.model.checkIn(dates[0]);\n          this.model.checkOut(dates[1]);\n        }\n      },\n\n      onPreCalendarPosition(_, __, fp) {\n        fp._positionElement = $('.searchbox__box--checkout', self.$el)[0];\n        setTimeout(() => { this._positionElement = this._input; }, 0);\n      },\n    });\n\n    $(this.$el).on('click', '.searchbox__box--checkin, .searchbox__box--checkout', (e) => {\n      e.preventDefault();\n\n      fp.isOpen = false;\n      fp.open(undefined, e.currentTarget);\n    });\n\n    $('.searchbox__box', this.$el).each((i, box) => {\n      $(box).data('popup', this.setuptPopper(box));\n    });\n\n    $('[data-trigger=\"spinner\"]', this.$el).on('changed.spinner', function () {\n      $(this).find('[data-spin=\"spinner\"]').trigger('change');\n    });\n  }\n\n  setuptPopper(el) {\n    const $html = $(el).find('.searchbox__popup');\n\n    if ($html.length === 0) {\n      return;\n    }\n\n    plugin.utils.dropdown($(el).find('.searchbox__box-wrap'), {\n      drop: '.searchbox__popup',\n      display: 'static',\n    });\n  }\n}\n\nexport default SearchForm\n","import $ from 'jquery'\nimport SearchForm from './search-form/index'\n\n$(function () {\n  $('.awebooking .searchbox, .awebooking-block .searchbox').each((i, el) => {\n    new SearchForm(el)\n  })\n})\n"],"names":["SearchModel","$","formatDate","date","format","_date","plugin","utils","dates","parse","i18n","dateFormat","Model","data","adults","ko","observable","children","infants","checkIn","checkOut","checkInDate","computed","checkOutDate","jQuery","SearchForm","el","self","$el","model","SearchFormModel","find","val","applyBindings","$rangepicker","length","appendTo","fp","datepicker","mode","inline","altInput","clickOpens","closeOnSelect","onReady","_","__","calendarContainer","classList","add","config","ignoredFocusElements","push","onChange","onPreCalendarPosition","_positionElement","setTimeout","_input","on","e","preventDefault","isOpen","open","undefined","currentTarget","each","i","box","setuptPopper","trigger","$html","dropdown","drop","display"],"mappings":"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"}