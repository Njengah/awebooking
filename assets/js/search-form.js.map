{"version":3,"names":[],"mappings":"","sources":["search-form.js"],"sourcesContent":["(function ($, ko, plugin) {\r\n  'use strict';\r\n\r\n  function formatDate(date) {\r\n    const _date = flatpickr.parseDate(date);\r\n\r\n    if (!_date) {\r\n      return '';\r\n    }\r\n\r\n    return flatpickr.formatDate(_date, plugin.i18n.dateFormat);\r\n  }\r\n\r\n  function SearchFormModel(data = {}) {\r\n    this.adult    = ko.observable(data.adult || 1);\r\n    this.children = ko.observable(data.children || 0);\r\n    this.infants  = ko.observable(data.infants || 0);\r\n    this.checkIn  = ko.observable(data.checkIn || '2018-07-05');\r\n    this.checkOut = ko.observable(data.checkOut || '2018-07-10');\r\n\r\n    this.checkInFormatted = ko.computed(() => {\r\n      return formatDate(this.checkIn());\r\n    });\r\n\r\n    this.checkOutFormatted = ko.computed(() => {\r\n      return formatDate(this.checkOut());\r\n    });\r\n  }\r\n\r\n  class SearchForm {\r\n    constructor (el) {\r\n      this.$el = $(el);\r\n\r\n      this.model = new SearchFormModel();\r\n      ko.applyBindings(this.model, el);\r\n\r\n      $('.searchbox__box', this.$el).each((i, box) => {\r\n        $(box).data('popup', this.setuptPopper(box));\r\n      });\r\n\r\n      const $checkin = this.$el.find('input[name=\"check_in\"]');\r\n      const $checkout = this.$el.find('input[name=\"check_out\"]');\r\n      const $rangepicker = this.$el.find('[data-hotel=\"rangepicker\"]');\r\n\r\n      // const rangedates = new RangeDatesPlugin({\r\n      //   firstInput: $checkin[0],\r\n      //   secondInput: $checkout[0]\r\n      // });\r\n\r\n      const fp = awebooking.datepicker($rangepicker[0], {\r\n        mode: 'range',\r\n        clickOpens: false,\r\n        closeOnSelect: true,\r\n\r\n        onReady() {\r\n          this.config.ignoredFocusElements.push($('.searchbox__box--checkin')[0]);\r\n          this.config.ignoredFocusElements.push($('.searchbox__box--checkout')[0]);\r\n        },\r\n\r\n        onChange: (dates) => {\r\n          if (dates.length === 0) {\r\n            this.model.checkIn(null);\r\n            this.model.checkIn(null);\r\n          } else if (dates.length === 1) {\r\n            this.model.checkIn(dates[0]);\r\n            this.model.checkOut(null);\r\n          } else {\r\n            this.model.checkIn(dates[0]);\r\n            this.model.checkOut(dates[1]);\r\n          }\r\n        },\r\n\r\n        onPreCalendarPosition() {\r\n          fp._positionElement = $('.searchbox__box--checkout')[0];\r\n          setTimeout(() => { this._positionElement = this._input; }, 0);\r\n        },\r\n      });\r\n\r\n      $('.searchbox__box--checkin, .searchbox__box--checkout')\r\n        .on('click focus', function(e) {\r\n          e.preventDefault();\r\n\r\n          fp.isOpen = false;\r\n          fp.open(undefined, this);\r\n        });\r\n    }\r\n\r\n    setuptPopper(el) {\r\n      const $html = $(el).find('.searchbox__popup');\r\n      if ($html.length === 0) {\r\n        return;\r\n      }\r\n\r\n      tippy(el, {\r\n        theme: 'awebooking-popup',\r\n        delay: 0,\r\n        arrow: true,\r\n        distance: 0,\r\n        placement: 'bottom',\r\n        trigger: 'click',\r\n        interactive: true,\r\n        performance: true,\r\n        hideOnClick: true,\r\n        animation: 'shift-toward',\r\n        duration: [150, 150],\r\n        html: $html[0],\r\n        popperOptions: { modifiers: {\r\n            hide: { enabled: false },\r\n            preventOverflow: { enabled: false },\r\n          }}\r\n      });\r\n\r\n      return el._tippy;\r\n    }\r\n  }\r\n\r\n  $(function () {\r\n    $('.searchbox').each(function () {\r\n      new SearchForm(this);\r\n    });\r\n  });\r\n\r\n})(jQuery, window.ko, window.awebooking);\r\n"],"file":"search-form.js"}