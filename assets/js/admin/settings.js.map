{"version":3,"file":"settings.js","sources":["assets/babel/admin/settings.js"],"sourcesContent":["(function($, plugin) {\n  'use strict';\n\n  const settings = window._awebookingSettings || {};\n\n  /**\n   * Handle leaving using window.onbeforeunload.\n   *\n   * @return {void}\n   */\n  function handleLeaving() {\n    let changed = false;\n\n    // Set the changed if any controls fire change.\n    $('input, textarea, select').on( 'change', function() {\n      changed = true;\n    });\n\n    $('.awebooking-settings')\n      .on('click', '.nav-tab-wrapper a', function() {\n        if (changed) {\n          window.onbeforeunload = function() {\n            return settings.i18n.nav_warning;\n          };\n        } else {\n          window.onbeforeunload = null;\n        }\n      })\n      .on('click', '.submit button', function() {\n        window.onbeforeunload = null;\n      });\n  }\n\n  /**\n   * Init the datepicker.\n   *\n   * @return {void}\n   */\n  function initDatepicker() {\n    $('#display_datepicker_disabledates').flatpickr({\n      mode: 'multiple',\n      dateFormat: 'Y-m-d'\n    });\n  }\n\n  /**\n   * Setup input table bindings.\n   *\n   * @return {void}\n   */\n  function setupInputTable() {\n    const $table = $('.awebooking-input-table');\n\n    let shifted, controlled, hasFocus;\n    shifted = controlled = hasFocus = false;\n\n    $(document).bind('keyup keydown', function (e) {\n      shifted = e.shiftKey;\n      controlled = e.ctrlKey || e.metaKey;\n    });\n\n    const handleClickInputTable = function(el, e) {\n      var $elRow = $(el).closest('tr');\n      var $elTable = $(el).closest('table, tbody');\n\n      if ((e.type === 'focus' && hasFocus !== $elRow.index()) || (e.type === 'click' && $(el).is(':focus'))) {\n        hasFocus = $elRow.index();\n\n        if (!shifted && !controlled) {\n          $('tr', $elTable).removeClass('current').removeClass('last-selected');\n          $elRow.addClass('current').addClass('last-selected');\n        } else if (shifted) {\n          $('tr', $elTable).removeClass('current');\n          $elRow.addClass('selected-now').addClass('current');\n\n          if ($('tr.last-selected', $elTable).length > 0) {\n            if ($elRow.index() > $('tr.last-selected', $elTable).index()) {\n              $('tr', $elTable).slice($('tr.last-selected', $elTable).index(), $elRow.index()).addClass('current');\n            } else {\n              $('tr', $elTable).slice($elRow.index(), $('tr.last-selected', $elTable).index() + 1).addClass('current');\n            }\n          }\n\n          $('tr', $elTable).removeClass('last-selected');\n          $elRow.addClass('last-selected');\n        } else {\n          $('tr', $elTable).removeClass('last-selected');\n          if (controlled && $(el).closest('tr').is('.current')) {\n            $elRow.removeClass('current');\n          } else {\n            $elRow.addClass('current').addClass('last-selected');\n          }\n        }\n\n        $('tr', $elTable).removeClass('selected-now');\n      }\n    };\n\n    const handleRemoveRows = function (el, e) {\n      var $tbody = $(el).closest('table').find('tbody');\n\n      if ($tbody.find('tr.current').length > 0) {\n        var $current = $tbody.find('tr.current');\n\n        $current.each(function () {\n          $(this).remove();\n        });\n      }\n    };\n\n    $table\n      .on('blur', 'input', () => {\n        hasFocus = false;\n      })\n      .on('focus click', 'input', function (e) {\n        handleClickInputTable(this, e);\n      })\n      .on('click', '.remove_rows', function (e) {\n        e.preventDefault();\n        handleRemoveRows(this, e);\n      });\n  }\n\n  function setupInputTableSortable() {\n    /*$('.wc_input_table.sortable tbody').sortable({\n      items: 'tr',\n      cursor: 'move',\n      axis: 'y',\n      scrollSensitivity: 40,\n      forcePlaceholderSize: true,\n      helper: 'clone',\n      opacity: 0.65,\n      placeholder: 'wc-metabox-sortable-placeholder',\n      start: function (event, ui) {\n        ui.item.css('background-color', '#f6f6f6');\n      },\n      stop: function (event, ui) {\n        ui.item.removeAttr('style');\n      }\n    });\n\n    // Focus on inputs within the table if clicked instead of trying to sort.\n    $('.wc_input_table.sortable tbody input').on('click', function () {\n      $(this).focus();\n    });*/\n  }\n\n  /** Document ready */\n  $(function() {\n    handleLeaving();\n    initDatepicker();\n\n    setupInputTable();\n    // setupInputTableSortable();\n  });\n\n})(jQuery, window.awebooking);\n"],"names":["$","plugin","settings","window","_awebookingSettings","handleLeaving","changed","on","onbeforeunload","i18n","nav_warning","initDatepicker","flatpickr","mode","dateFormat","setupInputTable","$table","shifted","controlled","hasFocus","document","bind","e","shiftKey","ctrlKey","metaKey","handleClickInputTable","el","$elRow","closest","$elTable","type","index","is","removeClass","addClass","length","slice","handleRemoveRows","$tbody","find","$current","each","remove","preventDefault","jQuery","awebooking"],"mappings":"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"}