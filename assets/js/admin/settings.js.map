{"version":3,"file":"settings.js","sources":["assets/babel/admin/settings.js"],"sourcesContent":["(function($, plugin) {\n  'use strict';\n\n  const settings = window._awebookingSettings || {};\n\n  /**\n   * Handle leaving using window.onbeforeunload.\n   *\n   * @return {void}\n   */\n  function handleLeaving() {\n    let changed = false;\n\n    // Set the changed if any controls fire change.\n    $('input, textarea, select').on( 'change', function() {\n      changed = true;\n    });\n\n    $('.awebooking-settings')\n      .on('click', '.nav-tab-wrapper a', function() {\n        if (changed) {\n          window.onbeforeunload = function() {\n            return settings.i18n.nav_warning;\n          };\n        } else {\n          window.onbeforeunload = null;\n        }\n      })\n      .on('click', '.submit button', function() {\n        window.onbeforeunload = null;\n      });\n  }\n\n  /**\n   * Init the datepicker.\n   *\n   * @return {void}\n   */\n  function initDatepicker() {\n    $('#display_datepicker_disabledates').flatpickr({\n      mode: 'multiple',\n      dateFormat: 'Y-m-d'\n    });\n  }\n\n  /**\n   * Setup input table bindings.\n   *\n   * @return {void}\n   */\n  function setupInputTable() {\n    const $table = $('.awebooking-input-table');\n\n    let shifted, controlled, hasFocus;\n    shifted = controlled = hasFocus = false;\n\n    $(document).bind('keyup keydown', function (e) {\n      shifted = e.shiftKey;\n      controlled = e.ctrlKey || e.metaKey;\n    });\n\n    const handleClickInputTable = function(el, e) {\n      var $elRow = $(el).closest('tr');\n      var $elTable = $(el).closest('table, tbody');\n\n      if ((e.type === 'focus' && hasFocus !== $elRow.index()) || (e.type === 'click' && $(el).is(':focus'))) {\n        hasFocus = $elRow.index();\n\n        if (!shifted && !controlled) {\n          $('tr', $elTable).removeClass('current').removeClass('last-selected');\n          $elRow.addClass('current').addClass('last-selected');\n        } else if (shifted) {\n          $('tr', $elTable).removeClass('current');\n          $elRow.addClass('selected-now').addClass('current');\n\n          if ($('tr.last-selected', $elTable).length > 0) {\n            if ($elRow.index() > $('tr.last-selected', $elTable).index()) {\n              $('tr', $elTable).slice($('tr.last-selected', $elTable).index(), $elRow.index()).addClass('current');\n            } else {\n              $('tr', $elTable).slice($elRow.index(), $('tr.last-selected', $elTable).index() + 1).addClass('current');\n            }\n          }\n\n          $('tr', $elTable).removeClass('last-selected');\n          $elRow.addClass('last-selected');\n        } else {\n          $('tr', $elTable).removeClass('last-selected');\n          if (controlled && $(el).closest('tr').is('.current')) {\n            $elRow.removeClass('current');\n          } else {\n            $elRow.addClass('current').addClass('last-selected');\n          }\n        }\n\n        $('tr', $elTable).removeClass('selected-now');\n      }\n    };\n\n    const handleRemoveRows = function (el, e) {\n      var $tbody = $(el).closest('table').find('tbody');\n\n      if ($tbody.find('tr.current').length > 0) {\n        var $current = $tbody.find('tr.current');\n\n        $current.each(function () {\n          $(this).remove();\n        });\n      }\n    };\n\n    $table\n      .on('blur', 'input', () => {\n        hasFocus = false;\n      })\n      .on('focus click', 'input', function (e) {\n        handleClickInputTable(this, e);\n      })\n      .on('click', '.remove_rows', function (e) {\n        e.preventDefault();\n        handleRemoveRows(this, e);\n      });\n  }\n\n  function setupInputTableSortable() {\n    /*$('.wc_input_table.sortable tbody').sortable({\n      items: 'tr',\n      cursor: 'move',\n      axis: 'y',\n      scrollSensitivity: 40,\n      forcePlaceholderSize: true,\n      helper: 'clone',\n      opacity: 0.65,\n      placeholder: 'wc-metabox-sortable-placeholder',\n      start: function (event, ui) {\n        ui.item.css('background-color', '#f6f6f6');\n      },\n      stop: function (event, ui) {\n        ui.item.removeAttr('style');\n      }\n    });\n\n    // Focus on inputs within the table if clicked instead of trying to sort.\n    $('.wc_input_table.sortable tbody input').on('click', function () {\n      $(this).focus();\n    });*/\n  }\n\n  /** Document ready */\n  $(function() {\n    handleLeaving();\n    initDatepicker();\n\n    setupInputTable();\n    // setupInputTableSortable();\n  });\n\n})(jQuery, window.awebooking);\n"],"names":["$","plugin","settings","window","_awebookingSettings","handleLeaving","changed","on","onbeforeunload","i18n","nav_warning","initDatepicker","flatpickr","mode","dateFormat","setupInputTable","$table","shifted","controlled","hasFocus","document","bind","e","shiftKey","ctrlKey","metaKey","handleClickInputTable","el","$elRow","closest","$elTable","type","index","is","removeClass","addClass","length","slice","handleRemoveRows","$tbody","find","$current","each","remove","preventDefault","jQuery","awebooking"],"mappings":";;;EAAA,CAAC,UAASA,CAAT,EAAYC,MAAZ,EAAoB;AACnB;EAEA,MAAMC,QAAQ,GAAGC,MAAM,CAACC,mBAAP,IAA8B,EAA/C;EAEA;;;;;;EAKA,WAASC,aAAT,GAAyB;EACvB,QAAIC,OAAO,GAAG,KAAd,CADuB;;EAIvBN,IAAAA,CAAC,CAAC,yBAAD,CAAD,CAA6BO,EAA7B,CAAiC,QAAjC,EAA2C,YAAW;EACpDD,MAAAA,OAAO,GAAG,IAAV;EACD,KAFD;EAIAN,IAAAA,CAAC,CAAC,sBAAD,CAAD,CACGO,EADH,CACM,OADN,EACe,oBADf,EACqC,YAAW;EAC5C,UAAID,OAAJ,EAAa;EACXH,QAAAA,MAAM,CAACK,cAAP,GAAwB,YAAW;EACjC,iBAAON,QAAQ,CAACO,IAAT,CAAcC,WAArB;EACD,SAFD;EAGD,OAJD,MAIO;EACLP,QAAAA,MAAM,CAACK,cAAP,GAAwB,IAAxB;EACD;EACF,KATH,EAUGD,EAVH,CAUM,OAVN,EAUe,gBAVf,EAUiC,YAAW;EACxCJ,MAAAA,MAAM,CAACK,cAAP,GAAwB,IAAxB;EACD,KAZH;EAaD;EAED;;;;;;;EAKA,WAASG,cAAT,GAA0B;EACxBX,IAAAA,CAAC,CAAC,kCAAD,CAAD,CAAsCY,SAAtC,CAAgD;EAC9CC,MAAAA,IAAI,EAAE,UADwC;EAE9CC,MAAAA,UAAU,EAAE;EAFkC,KAAhD;EAID;EAED;;;;;;;EAKA,WAASC,eAAT,GAA2B;EACzB,QAAMC,MAAM,GAAGhB,CAAC,CAAC,yBAAD,CAAhB;EAEA,QAAIiB,OAAJ,EAAaC,UAAb,EAAyBC,QAAzB;EACAF,IAAAA,OAAO,GAAGC,UAAU,GAAGC,QAAQ,GAAG,KAAlC;EAEAnB,IAAAA,CAAC,CAACoB,QAAD,CAAD,CAAYC,IAAZ,CAAiB,eAAjB,EAAkC,UAAUC,CAAV,EAAa;EAC7CL,MAAAA,OAAO,GAAGK,CAAC,CAACC,QAAZ;EACAL,MAAAA,UAAU,GAAGI,CAAC,CAACE,OAAF,IAAaF,CAAC,CAACG,OAA5B;EACD,KAHD;;EAKA,QAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAASC,EAAT,EAAaL,CAAb,EAAgB;EAC5C,UAAIM,MAAM,GAAG5B,CAAC,CAAC2B,EAAD,CAAD,CAAME,OAAN,CAAc,IAAd,CAAb;EACA,UAAIC,QAAQ,GAAG9B,CAAC,CAAC2B,EAAD,CAAD,CAAME,OAAN,CAAc,cAAd,CAAf;;EAEA,UAAKP,CAAC,CAACS,IAAF,KAAW,OAAX,IAAsBZ,QAAQ,KAAKS,MAAM,CAACI,KAAP,EAApC,IAAwDV,CAAC,CAACS,IAAF,KAAW,OAAX,IAAsB/B,CAAC,CAAC2B,EAAD,CAAD,CAAMM,EAAN,CAAS,QAAT,CAAlF,EAAuG;EACrGd,QAAAA,QAAQ,GAAGS,MAAM,CAACI,KAAP,EAAX;;EAEA,YAAI,CAACf,OAAD,IAAY,CAACC,UAAjB,EAA6B;EAC3BlB,UAAAA,CAAC,CAAC,IAAD,EAAO8B,QAAP,CAAD,CAAkBI,WAAlB,CAA8B,SAA9B,EAAyCA,WAAzC,CAAqD,eAArD;EACAN,UAAAA,MAAM,CAACO,QAAP,CAAgB,SAAhB,EAA2BA,QAA3B,CAAoC,eAApC;EACD,SAHD,MAGO,IAAIlB,OAAJ,EAAa;EAClBjB,UAAAA,CAAC,CAAC,IAAD,EAAO8B,QAAP,CAAD,CAAkBI,WAAlB,CAA8B,SAA9B;EACAN,UAAAA,MAAM,CAACO,QAAP,CAAgB,cAAhB,EAAgCA,QAAhC,CAAyC,SAAzC;;EAEA,cAAInC,CAAC,CAAC,kBAAD,EAAqB8B,QAArB,CAAD,CAAgCM,MAAhC,GAAyC,CAA7C,EAAgD;EAC9C,gBAAIR,MAAM,CAACI,KAAP,KAAiBhC,CAAC,CAAC,kBAAD,EAAqB8B,QAArB,CAAD,CAAgCE,KAAhC,EAArB,EAA8D;EAC5DhC,cAAAA,CAAC,CAAC,IAAD,EAAO8B,QAAP,CAAD,CAAkBO,KAAlB,CAAwBrC,CAAC,CAAC,kBAAD,EAAqB8B,QAArB,CAAD,CAAgCE,KAAhC,EAAxB,EAAiEJ,MAAM,CAACI,KAAP,EAAjE,EAAiFG,QAAjF,CAA0F,SAA1F;EACD,aAFD,MAEO;EACLnC,cAAAA,CAAC,CAAC,IAAD,EAAO8B,QAAP,CAAD,CAAkBO,KAAlB,CAAwBT,MAAM,CAACI,KAAP,EAAxB,EAAwChC,CAAC,CAAC,kBAAD,EAAqB8B,QAArB,CAAD,CAAgCE,KAAhC,KAA0C,CAAlF,EAAqFG,QAArF,CAA8F,SAA9F;EACD;EACF;;EAEDnC,UAAAA,CAAC,CAAC,IAAD,EAAO8B,QAAP,CAAD,CAAkBI,WAAlB,CAA8B,eAA9B;EACAN,UAAAA,MAAM,CAACO,QAAP,CAAgB,eAAhB;EACD,SAdM,MAcA;EACLnC,UAAAA,CAAC,CAAC,IAAD,EAAO8B,QAAP,CAAD,CAAkBI,WAAlB,CAA8B,eAA9B;;EACA,cAAIhB,UAAU,IAAIlB,CAAC,CAAC2B,EAAD,CAAD,CAAME,OAAN,CAAc,IAAd,EAAoBI,EAApB,CAAuB,UAAvB,CAAlB,EAAsD;EACpDL,YAAAA,MAAM,CAACM,WAAP,CAAmB,SAAnB;EACD,WAFD,MAEO;EACLN,YAAAA,MAAM,CAACO,QAAP,CAAgB,SAAhB,EAA2BA,QAA3B,CAAoC,eAApC;EACD;EACF;;EAEDnC,QAAAA,CAAC,CAAC,IAAD,EAAO8B,QAAP,CAAD,CAAkBI,WAAlB,CAA8B,cAA9B;EACD;EACF,KAnCD;;EAqCA,QAAMI,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAUX,EAAV,EAAcL,CAAd,EAAiB;EACxC,UAAIiB,MAAM,GAAGvC,CAAC,CAAC2B,EAAD,CAAD,CAAME,OAAN,CAAc,OAAd,EAAuBW,IAAvB,CAA4B,OAA5B,CAAb;;EAEA,UAAID,MAAM,CAACC,IAAP,CAAY,YAAZ,EAA0BJ,MAA1B,GAAmC,CAAvC,EAA0C;EACxC,YAAIK,QAAQ,GAAGF,MAAM,CAACC,IAAP,CAAY,YAAZ,CAAf;EAEAC,QAAAA,QAAQ,CAACC,IAAT,CAAc,YAAY;EACxB1C,UAAAA,CAAC,CAAC,IAAD,CAAD,CAAQ2C,MAAR;EACD,SAFD;EAGD;EACF,KAVD;;EAYA3B,IAAAA,MAAM,CACHT,EADH,CACM,MADN,EACc,OADd,EACuB,YAAM;EACzBY,MAAAA,QAAQ,GAAG,KAAX;EACD,KAHH,EAIGZ,EAJH,CAIM,aAJN,EAIqB,OAJrB,EAI8B,UAAUe,CAAV,EAAa;EACvCI,MAAAA,qBAAqB,CAAC,IAAD,EAAOJ,CAAP,CAArB;EACD,KANH,EAOGf,EAPH,CAOM,OAPN,EAOe,cAPf,EAO+B,UAAUe,CAAV,EAAa;EACxCA,MAAAA,CAAC,CAACsB,cAAF;EACAN,MAAAA,gBAAgB,CAAC,IAAD,EAAOhB,CAAP,CAAhB;EACD,KAVH;EAWD;EAGC;;;;;;;;;;;;;;;;;;;;;EAuBF;;;EACAtB,EAAAA,CAAC,CAAC,YAAW;EACXK,IAAAA,aAAa;EACbM,IAAAA,cAAc;EAEdI,IAAAA,eAAe,GAJJ;EAMZ,GANA,CAAD;EAQD,CA5JD,EA4JG8B,MA5JH,EA4JW1C,MAAM,CAAC2C,UA5JlB;;;;"}