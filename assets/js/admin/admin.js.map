{"version":3,"names":[],"mappings":"","sources":["admin/admin.js"],"sourcesContent":["const debounce = require('debounce');\nconst queryString = require('query-string');\n\n(function($) {\n  'use strict';\n\n\n  debounce(() => {\n\n  });\n\n  const awebooking = window.awebooking || {};\n\n  // Create the properties.\n  awebooking.utils = {};\n  awebooking.instances = {};\n\n  awebooking.utils.flatpickrRangePlugin = require('../core/range-dates.js');\n\n  /**\n   * The admin route.\n   *\n   * @param  {string} route\n   * @return {string}\n   */\n  awebooking.route = function(route) {\n    return this.admin_route + route.replace(/^\\//g, '');\n  };\n\n  /**\n   * Show the alert dialog.\n   *\n   * @return {SweetAlert}\n   */\n  awebooking.alert = function(message, type = 'error') {\n    return swal({\n      text: message,\n      type: type,\n      toast: true,\n      buttonsStyling: false,\n      showCancelButton: false,\n      showConfirmButton: true,\n      confirmButtonClass: 'button'\n    });\n  };\n\n  /**\n   * Show the confirm message.\n   *\n   * @return {SweetAlert}\n   */\n  awebooking.confirm = function(message, callback) {\n    if (! window.swal) {\n      return window.confirm(message || this.i18n.warning) && callback();\n    }\n\n    const confirm = window.swal({\n      toast: true,\n      text: message || this.i18n.warning,\n      type: 'warning',\n      position: 'center',\n      reverseButtons: true,\n      buttonsStyling: false,\n      showCancelButton: true,\n      cancelButtonClass: 'button',\n      confirmButtonClass: 'button button-primary',\n      cancelButtonText: this.i18n.cancel,\n      confirmButtonText: this.i18n.ok,\n    });\n\n    if (callback) {\n      return confirm.then(function(result) {\n        if (result.value) callback(result);\n      });\n    }\n\n    return confirm;\n  };\n\n  /**\n   * Create the dialog.\n   *\n   * @param  {string} selector\n   * @return {Object}\n   */\n  awebooking.dialog = function(selector) {\n    const $dialog = $(selector).dialog({\n      modal: true,\n      width: 'auto',\n      height: 'auto',\n      autoOpen: false,\n      draggable: false,\n      resizable: false,\n      closeOnEscape: true,\n      dialogClass: 'wp-dialog awebooking-dialog',\n      position: { my: 'center', at: 'center center-15%', of: window },\n    });\n\n    $(window).resize(debounce(() => {\n      $dialog.dialog('option', 'position', { my: 'center', at: 'center center-15%', of: window });\n    }, 150));\n\n    return $dialog;\n  };\n\n  /**\n   * Send a ajax request to a route.\n   *\n   * @param  {String}   route\n   * @param  {Object}   data\n   * @param  {Function} callback\n   * @return {Object}\n   */\n  awebooking.ajax = function(method, route, data, callback) {\n    return $.ajax({\n      url: awebooking.route(route),\n      data: data,\n      method: method,\n      dataType: 'json',\n    })\n    .done((data) => {\n      if(callback) callback(data);\n    })\n    .fail((xhr) => {\n      const json = xhr.responseJSON;\n\n      if (json && json.message) {\n        awebooking.alert(json.message, 'error');\n      } else {\n        awebooking.alert(awebooking.i18n.error, 'error');\n      }\n    });\n  };\n\n  /**\n   * Create a form then append to body.\n   *\n   * @param  {String} link   The form action.\n   * @param  {String} method The form method.\n   * @return {Object}\n   */\n  awebooking.createForm = function(action, method) {\n    const $form = $('<form>', { 'method': 'POST', 'action': action });\n\n    const hiddenInput = $('<input>', { 'name': '_method',  'type': 'hidden', 'value': method });\n\n    return $form.append(hiddenInput).appendTo('body');\n  };\n\n  /**\n   * Format the price.\n   *\n   * @param amount\n   * @returns {string}\n   */\n  awebooking.formatPrice = function(amount) {\n    return require('accounting').formatMoney(amount, {\n      format: awebooking.i18n.priceFormat,\n      symbol: awebooking.i18n.currencySymbol,\n      decimal: awebooking.i18n.decimalSeparator,\n      thousand: awebooking.i18n.priceThousandSeparator,\n      precision: awebooking.i18n.numberDecimals,\n    });\n  };\n\n  /**\n   * Retrieves a modified URL query string.\n   *\n   * @param {object} args\n   * @param {string} url\n   */\n  awebooking.utils.addQueryArgs =function(args, url) {\n    if (typeof url === 'undefined') {\n      url = window.location.href;\n    }\n\n    const parsed = queryString.parseUrl(url);\n    const query  = $.extend({}, parsed.query, args);\n\n    return parsed.url + '?' + queryString.stringify(query, { sort: false });\n  };\n\n  $(function() {\n    // Init tippy.\n    if (window.tippy) {\n      window.tippy('.tippy', {\n        arrow: true,\n        animation: 'shift-toward',\n        duration: [200, 150],\n      });\n    }\n\n    // Init the selectize.\n    if ($.fn.selectize) {\n      require('./utils/search-customer.js')();\n\n      $('select.selectize, .with-selectize .cmb2_select').selectize({\n        allowEmptyOption: true,\n        searchField: ['value', 'text'],\n      });\n    }\n\n    // Init warning before delete.\n    $('[data-method=\"abrs-delete\"]').on( 'click', function(e) {\n      e.preventDefault();\n\n      const link = $(this).attr('href');\n      const message = $(this).data('warning');\n\n      awebooking.confirm(message, function() {\n        awebooking.createForm(link, 'DELETE').submit();\n      });\n    });\n  });\n\n  module.exports = function () {\n\n  };\n\n})(jQuery);\n"],"file":"admin.js"}