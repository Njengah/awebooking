{"version":3,"names":[],"mappings":"","sources":["admin/edit-room-type.js"],"sourcesContent":["(function($, plugin, document) {\n  'use strict';\n\n  const data = window._awebookingRooms || {};\n\n  class RoomsGenerator {\n    constructor() {\n      this.rooms = ko.observableArray(data.rooms || []);\n      this.scaffoldNumber = ko.observable(0);\n    }\n\n    add() {\n      const title = this.getCurrentTitle();\n      const length = this.rooms().length;\n\n      this.rooms.push({\n        id: -1,\n        name: `${title} ${length + 1}`,\n      });\n    }\n\n    remove(item, e) {\n      const self = this;\n\n      if (item.id < 0) {\n        this._removeItemEffect(item, e);\n        return;\n      }\n\n      const ajaxDelete = function() {\n        return plugin.ajax('DELETE', `/ajax/delete-room/${item.id}`, {\n          _method: 'DELETE',\n          _wpnonce: data.deleteNonce,\n        }, function (data) {\n          self._removeItemEffect(item, e);\n          plugin.alert(data.message, 'success');\n        });\n      };\n\n      plugin.confirm(plugin.i18n.warning, () => {\n        ajaxDelete();\n      });\n    }\n\n    _removeItemEffect(item, e) {\n      $(e.currentTarget).closest('li').effect('highlight', {}, 150, () => {\n        this.rooms.remove(item);\n      });\n    }\n\n    scaffold() {\n      const title = this.getCurrentTitle();\n      const total = parseInt(this.scaffoldNumber(), 10) || 1;\n\n      // Clear the rooms.\n      this.rooms([]);\n\n      for (var i = 0; i < total; i++) {\n        this.rooms.push({\n          id: -1,\n          name: `${title} ${i + 1}`,\n        });\n      }\n    }\n\n    getCurrentTitle() {\n      let titleEl = document.getElementById('title');\n      return titleEl ? titleEl.value.trim() : 'R';\n    }\n  }\n\n  $(function() {\n    // Apply rooms generator binding.\n    ko.applyBindings(new RoomsGenerator(), document.getElementById('js-rooms-list'));\n\n    const $roomSortable = $('.js-sorting-rooms');\n\n    if ($roomSortable.length > 0) {\n      new Sortable($roomSortable[0], {\n        handle: '.abrs-sortable__handle',\n        animation: 150,\n      });\n    }\n\n    // Handle click on tabs.\n    const $metabox = $('#awebooking-room-type-data');\n    $('.awebooking-tabs > li:first > a', $metabox).trigger('click');\n\n    $metabox.on('click', '.awebooking-tabs a', (e) => {\n      e.preventDefault();\n      const $target = $(e.target);\n\n      $('.awebooking-tabs > li.active', $metabox).removeClass('active');\n      $target.parent().addClass('active');\n\n      $('.awebooking-tabs-panels > div', $metabox).hide();\n      $($target.attr('href'), this.$metabox).show();\n    });\n\n    /**\n     * Scroll to first checked category.\n     *\n     * @link https://github.com/scribu/wp-category-checklist-tree/blob/master/category-checklist-tree.php\n     */\n    $('[id$=\"-all\"] > ul.categorychecklist').each(function() {\n      const $list = $(this);\n      const $firstChecked = $list.find(':checked').first();\n\n      if (! $firstChecked.length) {\n        return;\n      }\n\n      const posFirst = $list.find('input').position().top;\n      const posChecked = $firstChecked.position().top;\n\n      $list.closest('.tabs-panel').scrollTop(posChecked - posFirst + 5);\n    });\n  });\n\n})(jQuery, window.awebooking, document);\n"],"file":"edit-room-type.js"}