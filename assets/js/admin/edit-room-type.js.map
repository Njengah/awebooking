{"version":3,"file":"edit-room-type.js","sources":["assets/babel/admin/edit-room-type.js"],"sourcesContent":["(function($, plugin, document) {\n  'use strict';\n\n  const data = window._awebookingRooms || {};\n\n  class RoomsGenerator {\n    constructor() {\n      this.rooms = ko.observableArray(data.rooms || []);\n      this.scaffoldNumber = ko.observable(0);\n    }\n\n    add() {\n      const title = this.getCurrentTitle();\n      const length = this.rooms().length;\n\n      this.rooms.push({\n        id: -1,\n        name: `${title} ${length + 1}`,\n      });\n    }\n\n    remove(item, e) {\n      const self = this;\n\n      if (item.id < 0) {\n        this._removeItemEffect(item, e);\n        return;\n      }\n\n      const ajaxDelete = function() {\n        return plugin.ajax('DELETE', `/ajax/delete-room/${item.id}`, {\n          _method: 'DELETE',\n          _wpnonce: data.deleteNonce,\n        }, function (data) {\n          self._removeItemEffect(item, e);\n          plugin.alert(data.message, 'success');\n        });\n      };\n\n      plugin.confirm(plugin.i18n.warning, () => {\n        ajaxDelete();\n      });\n    }\n\n    _removeItemEffect(item, e) {\n      $(e.currentTarget).closest('li').effect('highlight', {}, 150, () => {\n        this.rooms.remove(item);\n      });\n    }\n\n    scaffold() {\n      const title = this.getCurrentTitle();\n      const total = parseInt(this.scaffoldNumber(), 10) || 1;\n\n      // Clear the rooms.\n      this.rooms([]);\n\n      for (var i = 0; i < total; i++) {\n        this.rooms.push({\n          id: -1,\n          name: `${title} ${i + 1}`,\n        });\n      }\n    }\n\n    getCurrentTitle() {\n      let titleEl = document.getElementById('title');\n      return titleEl ? titleEl.value.trim() : 'R';\n    }\n  }\n\n  $(function() {\n    // Apply rooms generator binding.\n    ko.applyBindings(new RoomsGenerator(), document.getElementById('js-rooms-list'));\n\n    const $roomSortable = $('.js-sorting-rooms');\n\n    if ($roomSortable.length > 0) {\n      new Sortable($roomSortable[0], {\n        handle: '.abrs-sortable__handle',\n        animation: 150,\n      });\n    }\n\n    // Handle click on tabs.\n    const $metabox = $('#awebooking-room-type-data');\n    $('.awebooking-tabs > li:first > a', $metabox).trigger('click');\n\n    $metabox.on('click', '.awebooking-tabs a', (e) => {\n      e.preventDefault();\n      const $target = $(e.target);\n\n      $('.awebooking-tabs > li.active', $metabox).removeClass('active');\n      $target.parent().addClass('active');\n\n      $('.awebooking-tabs-panels > div', $metabox).hide();\n      $($target.attr('href'), this.$metabox).show();\n    });\n\n    /**\n     * Scroll to first checked category.\n     *\n     * @link https://github.com/scribu/wp-category-checklist-tree/blob/master/category-checklist-tree.php\n     */\n    $('[id$=\"-all\"] > ul.categorychecklist').each(function() {\n      const $list = $(this);\n      const $firstChecked = $list.find(':checked').first();\n\n      if (! $firstChecked.length) {\n        return;\n      }\n\n      const posFirst = $list.find('input').position().top;\n      const posChecked = $firstChecked.position().top;\n\n      $list.closest('.tabs-panel').scrollTop(posChecked - posFirst + 5);\n    });\n  });\n\n})(jQuery, window.awebooking, document);\n"],"names":["$","plugin","document","data","window","_awebookingRooms","RoomsGenerator","rooms","ko","observableArray","scaffoldNumber","observable","title","getCurrentTitle","length","push","id","name","item","e","self","_removeItemEffect","ajaxDelete","ajax","_method","_wpnonce","deleteNonce","alert","message","confirm","i18n","warning","currentTarget","closest","effect","remove","total","parseInt","i","titleEl","getElementById","value","trim","applyBindings","$roomSortable","Sortable","handle","animation","$metabox","trigger","on","preventDefault","$target","target","removeClass","parent","addClass","hide","attr","show","each","$list","$firstChecked","find","first","posFirst","position","top","posChecked","scrollTop","jQuery","awebooking"],"mappings":"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"}