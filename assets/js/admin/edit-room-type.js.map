{"version":3,"file":"edit-room-type.js","sources":["assets/babel/admin/edit-room-type.js"],"sourcesContent":["(function($, plugin, document) {\n  'use strict';\n\n  const data = window._awebookingRooms || {};\n\n  class RoomsGenerator {\n    constructor() {\n      this.rooms = ko.observableArray(data.rooms || []);\n      this.scaffoldNumber = ko.observable(0);\n    }\n\n    add() {\n      const title = this.getCurrentTitle();\n      const length = this.rooms().length;\n\n      this.rooms.push({\n        id: -1,\n        name: `${title} ${length + 1}`,\n      });\n    }\n\n    remove(item, e) {\n      const self = this;\n\n      if (item.id < 0) {\n        this._removeItemEffect(item, e);\n        return;\n      }\n\n      const ajaxDelete = function() {\n        return plugin.ajax('DELETE', `/ajax/delete-room/${item.id}`, {\n          _method: 'DELETE',\n          _wpnonce: data.deleteNonce,\n        }, function (data) {\n          self._removeItemEffect(item, e);\n          plugin.alert(data.message, 'success');\n        });\n      };\n\n      plugin.confirm(plugin.i18n.warning, () => {\n        ajaxDelete();\n      });\n    }\n\n    _removeItemEffect(item, e) {\n      $(e.currentTarget).closest('li').effect('highlight', {}, 150, () => {\n        this.rooms.remove(item);\n      });\n    }\n\n    scaffold() {\n      const title = this.getCurrentTitle();\n      const total = parseInt(this.scaffoldNumber(), 10) || 1;\n\n      // Clear the rooms.\n      this.rooms([]);\n\n      for (var i = 0; i < total; i++) {\n        this.rooms.push({\n          id: -1,\n          name: `${title} ${i + 1}`,\n        });\n      }\n    }\n\n    getCurrentTitle() {\n      let titleEl = document.getElementById('title');\n      return titleEl ? titleEl.value.trim() : 'R';\n    }\n  }\n\n  $(function() {\n    // Apply rooms generator binding.\n    ko.applyBindings(new RoomsGenerator(), document.getElementById('js-rooms-list'));\n\n    const $roomSortable = $('.js-sorting-rooms');\n\n    if ($roomSortable.length > 0) {\n      new Sortable($roomSortable[0], {\n        handle: '.abrs-sortable__handle',\n        animation: 150,\n      });\n    }\n\n    // Handle click on tabs.\n    const $metabox = $('#awebooking-room-type-data');\n    $('.awebooking-tabs > li:first > a', $metabox).trigger('click');\n\n    $metabox.on('click', '.awebooking-tabs a', (e) => {\n      e.preventDefault();\n      const $target = $(e.target);\n\n      $('.awebooking-tabs > li.active', $metabox).removeClass('active');\n      $target.parent().addClass('active');\n\n      $('.awebooking-tabs-panels > div', $metabox).hide();\n      $($target.attr('href'), this.$metabox).show();\n    });\n\n    /**\n     * Scroll to first checked category.\n     *\n     * @link https://github.com/scribu/wp-category-checklist-tree/blob/master/category-checklist-tree.php\n     */\n    $('[id$=\"-all\"] > ul.categorychecklist').each(function() {\n      const $list = $(this);\n      const $firstChecked = $list.find(':checked').first();\n\n      if (! $firstChecked.length) {\n        return;\n      }\n\n      const posFirst = $list.find('input').position().top;\n      const posChecked = $firstChecked.position().top;\n\n      $list.closest('.tabs-panel').scrollTop(posChecked - posFirst + 5);\n    });\n  });\n\n})(jQuery, window.awebooking, document);\n"],"names":["$","plugin","document","data","window","_awebookingRooms","RoomsGenerator","rooms","ko","observableArray","scaffoldNumber","observable","title","getCurrentTitle","length","push","id","name","item","e","self","_removeItemEffect","ajaxDelete","ajax","_method","_wpnonce","deleteNonce","alert","message","confirm","i18n","warning","currentTarget","closest","effect","remove","total","parseInt","i","titleEl","getElementById","value","trim","applyBindings","$roomSortable","Sortable","handle","animation","$metabox","trigger","on","preventDefault","$target","target","removeClass","parent","addClass","hide","attr","show","each","$list","$firstChecked","find","first","posFirst","position","top","posChecked","scrollTop","jQuery","awebooking"],"mappings":"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"}